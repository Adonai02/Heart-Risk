---
output: github_document
---


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


```{r include = FALSE}
library(DBI)
library(ggplot2)
library(tidyverse)
connect_own<-function() {
  
  options(mysql = list(
    "host" = "localhost", 
    "port" = 3306,
    "user" = "abel",
    "password" = "T77vqlra$"
    
  ))
  
  
  db <- RMySQL::dbConnect(RMySQL::MySQL(), dbname = "PROYECTO_5",
                          host = options()$mysql$host, 
                          port = options()$mysql$port, user = options()$mysql$user, 
                          password = options()$mysql$password)  
  
  
  
  return(db)
}

con_own <- connect_own()
table <- dbReadTable(con_own, "Tabla_Proyecto_5")
data <- data.frame(table)
```
# Heart Risk



The goal of Heart-Risk is to ...

***

## Export and visualitation of data


First, We going to export the dataset from MYSQL using the package DBI, the head of the dataset 
is following:

```{r echo=FALSE}
head(data)
```

Let's describe the variables:


* **Description's variables**


Once We known the decription of the variables, now, as we want to know if a person might have 
Heart disease or not, so, We will tranform to binary the *class* variable, and as factor the
variable *sex*  for work better with the data.


```{r pressure, echo = FALSE}
data["class_binomial"] <- ifelse(data$class==0, 0, 1)
data <- data %>% mutate(sex = factor(sex, labels = c("Female", "Male"))) #Preguntar a Roberto
str(data)
```


As you can see We already have converted the class and sex variables, now, let's identify the **Relevant** variables.

***

## Exploring the data

* Recommendation: Review concepts of t-test (Welch's t-test) and Chi-squared to identify relevant variables. 

**a)** We test the Chi function between the variables *Sex* and *class_binomial*, we obtain.

```{r echo=FALSE}
chisq.test(data$sex, data$class_binomial)
```


**b)** We test the t-test function between the variables *Age* and *class_binomial*, we obtain.

```{r echo=FALSE}
t.test(data$age, data$class_binomial)
```


**c)** We test the t-test function between the variables *Thalach* and *class_binomial*, we obtain.

```{r echo=FALSE}
t.test(data$thalach, data$class_binomial)
```

* **Conclusion of tests**

***

## Visualitation of data

Let's plot some relevant variables to have an idea about the distribution of it.

```{r echo=FALSE}
data["hd"] <- ifelse(data$class_binomial==1, "Disease", "No Disease")
ggplot(data, aes(x=hd, y=age) ) + geom_boxplot() + ggtitle("Boxplot Class binomial vs Age") +xlab("Class binomial") + ylab("Age")
```


```{r echo=FALSE}

ggplot(data, aes(x=hd, y=sex, fill=sex) ) + geom_bar(stat="identity") + ggtitle("Barplot Sex vs Class binomial") + xlab("Class binomial") + ylab("Sex")

```


```{r echo=FALSE}

ggplot(data, aes(x=hd, y=thalach) ) + geom_boxplot() + ggtitle("Barplot Thalach vs Class binomial") + xlab("Class binomial") + ylab("Thalach")

```


* **Conclusion of plots**


***

## Logistic Regression 

